--Below are practice problems utilizing the chinook database found on Charlotte Chaze's
--Data Analytics course. The dataset, chinook, represents a digital media store and 
--includes these tables: artists, albums, media tracks, invoices, and customers.

//1. Show Customers (their full names, customer ID, and country) who are not in the US. 

  Select FirstName, LastName, CustomerId, Country From chinook.customers Where Country <> 'USA';

//2. Show only the customers from Brazil

  Select FirstName, LastName, CustomerId, Country From chinook.customers Where Country = 'Brazil';

//3. Find the Invoices of customers who are from Brazil. The resulting table should
//show the customer's full name, Invoice ID, Date of the invoice, and billing country.

Select cust.FirstName, cust.LastName, inv.InvoiceId, inv.InvoiceDate, inv.BillingCountry
From chinook.customers cust
Left Join chinook.invoices inv
On cust.CustomerId = inv.CustomerId;

//4. Show the employees who are sales agents

Select FirstName, LastName, Title From chinook.employees Where Title Like "%Sales%Agent%"; 

//5. Find a unique/distinct list of billing countries from the Invoice table.

Select Distinct BillingCountry From chinook.invoices;

//6.Provide a query that shows the invoices associated with each sales agent.
//The resulting table should include the Sales Agent's full name.

 Select e.FirstName, e.LastName, i.invoiceid
  From (chinook.employees e
  Join chinook.customers c
  On c.supportRepId = e.EmployeeId)
  Join chinook.invoices i On i.CustomerId = c.CustomerId; 

//This is a cool example of doing three Joins at once. You'll see in the parentheses
//we're doing a join of employees and customers, then outside of the parentheses we
//Join on invoices. 

//7. Show the Invoice Total, Customer name, Country, and Sales Agent name for all
//invoices and customers.

Select i.Total as 'Invoice Total', c.FirstName as 'Customer', c.LastName as 'Name', c.Country, e.FirstName as 'Sales', e.LastName as 'Agent Name'
 From (chinook.invoices i Full Join chinook.customers c 
   On i.CustomerId = c.CustomerId)
   Full Join chinook.employees e
   On e.EmployeeId = c.supportRepId
   Where Title = 'Sales Support Agent';

//8. How many Invoices were there in 2009?
Select count(invoiceId) From chinook.invoices
Where InvoiceDate Like '2009%';

//9. What are the total sales for 2009?
Select Sum(Total) From chinook.invoices
Where InvoiceDate Like '2009%';

//10. Write a query that includes the purchased track name with each invoice line ID.



